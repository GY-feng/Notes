# 4-使用张量表征真实数据

神经网络当中的所以参数都是张量，比如：权重、偏置、输入输出

## 4.1处理图像

图像：被表示为一个排列在具有高度和宽度的规则网络的标量集合，其中高度和宽度以像素为单位
（标量集合： 图像中的每个像素都是一个标量，它表示图像在特定位置上的亮度或颜色值。这些标量值可以是灰度值（单通道图像）或颜色通道的组合（彩色图像）。）
表示像素值的标量通常使用8位整数编码，但也会在工业当中使用更高的12/16位

颜色通道：颜色编码为数字：RGB，可以把一个颜色通道看做一个灰度强度图，只对应所讨论的颜色

加载图像文件：

```py
import imageio

img_arr=imageio.imread('文件地址')
img_arr.shape()
#使用torchvision也是很好的！
```
img是一个三个维度类似Numpy数组的对象，两个空间维度：宽度和高度。第三个维度对应红绿蓝通道。
输出Numpy数组的库可以获得一个pytorch张量，注意：pytorch对应的张量要求：C×H×W（通道，高度，宽度）

改变布局：
```py
img=torch.from_numpy(img_arr)
out=img.permute(2,0,1)#第一个维度（2）现在将成为新张量的第一个维度，第二个维度（0）成为第二个维度，第三个维度（1）成为第三个维度。换句话说，这行代码将原始张量的通道维度移动到了第一个位置，高度和宽度维度分别移到了第二和第三个位置。
```
给定一个HxWxC的通道
permute使得每个旧的维度得到一个合适的布局

创建一个多图的数据集作为神经网络的输入：以获得一个N×C×H×W的张量
更好的方法：预先分配一个适当大小的张量，并且使用目录的图像来加载它：
```py
batch_size=3
#批处理将由3幅高度256像素，宽度256像素的RGB图像组成
batch=torch.zeros(batch_size,3,256,256)

【代码略】
```

正规化数据：

将浮点数的数值进行归一化以方便后续的处理方法：
方案A：将所有像素除以255
方案B:计算输入数据的均值和标准差，并且对其进行缩放，使得每个通道的均值为0，标准差为1